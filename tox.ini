[tox]
skipsdist = true
envlist = py27, py33, py34, py35, py36, pypy

[testenv]
deps =
    pytest
    pytest-cov
    pytest-flakes
    werkzeug
    webob
    py35,py36: multidict
    cython
    pyroma
    pygments
    collective.checkdocs
usedevelop = true
commands =
    python setup.py build_ext --inplace
    pytest
    pyroma -d {toxinidir}
    python setup.py checkdocs


[testenv:dev]
setenv = VALIDATEIT_DEV = 1
deps =
    pytest
    pytest-cov
    pytest-flakes
    werkzeug
    webob
    multidict
    cython
usedevelop = true
basepython = python3.6
commands =
    python setup.py build_ext --inplace
    pytest {posargs}


[testenv:bm]
deps =
    pytest
    pytest-benchmark
    cython
usedevelop = true
basepython = python3.6
commands =
    python setup.py build_ext --inplace
    pytest -c pytest-bm.ini {posargs}


[testenv:docs]
deps =
    sphinx
usedevelop = true
basepython = python3.6
commands =
    sphinx-build -W -b doctest -d {envtmpdir}/doctrees {toxinidir}/docs {envtmpdir}/doctest
    sphinx-build -W -b html -d {envtmpdir}/doctrees {toxinidir}/docs {envtmpdir}/html
